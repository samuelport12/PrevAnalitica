<!DOCTYPE html>
<html lang="pt-BR" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrevAnalitica AI | Assistente Jurídico</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        background: '#121212',
                        surface: '#1E1E1E',
                        surfaceHighlight: '#252525',
                        border: '#333333',
                        primary: {
                            400: '#4ADE80',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Fonte Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Ícones -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- Estilos Personalizados -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body
    class="bg-background text-gray-200 min-h-screen flex flex-col antialiased selection:bg-primary-500 selection:text-white">

    <!-- Navbar -->
    <nav class="w-full border-b border-border bg-background/95 backdrop-blur z-40 sticky top-0">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <!-- Logo -->
            <div class="flex items-center gap-2.5">
                <div class="bg-primary-600/20 p-2 rounded-lg">
                    <i class="ph-fill ph-scales text-2xl text-primary-500"></i>
                </div>
                <span class="font-bold text-xl tracking-tight text-white">PrevAnalitica</span>
            </div>

            <!-- Menu Desktop -->
            <div class="hidden md:flex items-center gap-8 text-sm font-medium text-gray-400 ml-auto">
                <button onclick="window.location.reload()"
                    class="text-white hover:text-primary-400 transition-colors">Nova Análise</button>
                <button onclick="document.getElementById('historyModal').classList.remove('hidden')"
                    class="hover:text-white transition-colors flex items-center gap-2">
                    <i class="ph ph-clock-counter-clockwise"></i> Histórico
                </button>
                <button onclick="document.getElementById('modelsModal').classList.remove('hidden')"
                    class="hover:text-white transition-colors flex items-center gap-2">
                    <i class="ph ph-files"></i> Modelos
                </button>
            </div>

            <!-- Mobile Menu Button -->
            <div class="flex items-center gap-4">
                <button class="md:hidden p-2 text-gray-400"
                    onclick="document.getElementById('mobileMenu').classList.toggle('hidden')">
                    <i class="ph ph-list text-2xl"></i>
                </button>
            </div>
        </div>

        <!-- Menu Mobile Dropdown -->
        <div id="mobileMenu" class="hidden md:hidden bg-surface border-b border-border p-4 space-y-3">
            <button onclick="window.location.reload()" class="block w-full text-left text-white py-2">Nova
                Análise</button>
            <button onclick="document.getElementById('historyModal').classList.remove('hidden')"
                class="block w-full text-left text-gray-400 hover:text-white py-2">Histórico</button>
            <button onclick="document.getElementById('modelsModal').classList.remove('hidden')"
                class="block w-full text-left text-gray-400 hover:text-white py-2">Modelos</button>
        </div>
    </nav>

    <!-- Conteúdo Principal -->
    <main class="flex-grow w-full max-w-7xl mx-auto px-4 sm:px-6 py-10">

        <div class="mb-10 text-center md:text-left">
            <h1 class="text-3xl md:text-4xl font-bold text-white mb-2">
                Análise de Processos <span class="text-primary-500">Inteligente</span>
            </h1>
            <p class="text-gray-400 max-w-2xl">
                Preencha os dados do requerente para gerar uma peça jurídica completa.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">

            <!-- Formulário -->
            <div class="lg:col-span-5 flex flex-col gap-6">
                <div class="bg-surface border border-border rounded-2xl p-1 shadow-2xl shadow-black/50">
                    <div class="bg-[#181818] rounded-xl p-6 sm:p-8 space-y-6">
                        <div class="flex items-center justify-between mb-2">
                            <h2 class="text-lg font-semibold text-white">Dados do Requerimento</h2>
                            <div class="h-1 w-12 bg-primary-600 rounded-full"></div>
                        </div>

                        <form id="prevForm" class="space-y-5">
                            <div class="space-y-1.5">
                                <label class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Tipo de
                                    Ação</label>
                                <div class="relative">
                                    <select name="tipo_acao" id="inputTipo"
                                        class="w-full bg-background border border-border text-gray-100 text-sm rounded-lg focus:ring-1 focus:ring-primary-500 focus:border-primary-500 block p-3 appearance-none transition-shadow outline-none">
                                        <option value="Restabelecimento de BPC/LOAS">Restabelecimento de BPC/LOAS
                                        </option>
                                        <option value="Concessão de BPC Deficiente">Concessão de BPC Deficiente</option>
                                        <option value="Aposentadoria Rural">Aposentadoria Rural</option>
                                        <option value="Salário Maternidade Rural">Salário Maternidade Rural</option>
                                        <option value="Auxílio por Incapacidade (Doença)">Auxílio por Incapacidade
                                        </option>
                                    </select>
                                    <i
                                        class="ph-bold ph-caret-down absolute right-3 top-3.5 text-gray-500 pointer-events-none"></i>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div class="col-span-2 space-y-1.5">
                                    <label
                                        class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Cliente</label>
                                    <input type="text" name="nome" id="inputNome" placeholder="Nome completo"
                                        class="w-full bg-background border border-border text-gray-100 text-sm rounded-lg focus:ring-1 focus:ring-primary-500 focus:border-primary-500 block p-3 outline-none placeholder-gray-600 transition-all"
                                        required>
                                </div>
                                <div class="space-y-1.5">
                                    <label
                                        class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Idade</label>
                                    <input type="number" name="idade" id="inputIdade" placeholder="Ex: 60"
                                        class="w-full bg-background border border-border text-gray-100 text-sm rounded-lg focus:ring-1 focus:ring-primary-500 focus:border-primary-500 block p-3 outline-none placeholder-gray-600 transition-all">
                                </div>
                                <div class="space-y-1.5">
                                    <label
                                        class="text-xs font-semibold text-gray-400 uppercase tracking-wider">NB</label>
                                    <input type="text" name="nb" id="inputNb" placeholder="000.000.000-0"
                                        class="w-full bg-background border border-border text-gray-100 text-sm rounded-lg focus:ring-1 focus:ring-primary-500 focus:border-primary-500 block p-3 outline-none placeholder-gray-600 transition-all">
                                </div>
                            </div>

                            <div
                                class="p-4 bg-background/50 rounded-lg border border-dashed border-border grid grid-cols-2 gap-4">
                                <div class="space-y-1">
                                    <label class="text-xs text-gray-500">Data Cessação/DER</label>
                                    <input type="date" name="data_cessacao" id="inputDataCessacao"
                                        class="w-full bg-transparent border-b border-border text-gray-200 text-sm py-1 focus:border-primary-500 outline-none transition-colors">
                                </div>
                                <div class="space-y-1">
                                    <label class="text-xs text-gray-500">Data Laudo</label>
                                    <input type="date" name="data_laudo" id="inputDataLaudo"
                                        class="w-full bg-transparent border-b border-border text-gray-200 text-sm py-1 focus:border-primary-500 outline-none transition-colors">
                                </div>
                            </div>

                            <div class="space-y-1.5">
                                <label class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Patologias
                                    (CIDs)</label>
                                <input type="text" name="cids" id="inputCids" placeholder="Ex: F91.3, M54.5..."
                                    class="w-full bg-background border border-border text-gray-100 text-sm rounded-lg focus:ring-1 focus:ring-primary-500 focus:border-primary-500 block p-3 outline-none placeholder-gray-600 transition-all">
                            </div>

                            <div class="space-y-1.5">
                                <label class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Contexto
                                    Fático</label>
                                <textarea name="contexto" id="inputContexto" rows="4"
                                    class="w-full bg-background border border-border text-gray-100 text-sm rounded-lg focus:ring-1 focus:ring-primary-500 focus:border-primary-500 block p-3 outline-none placeholder-gray-600 transition-all resize-none"
                                    placeholder="Descreva a realidade social, rural ou médica do cliente..."></textarea>
                            </div>

                            <button type="submit" id="btnGerar"
                                class="w-full group relative flex justify-center items-center py-3.5 px-4 border border-transparent text-sm font-semibold rounded-lg text-white bg-primary-600 hover:bg-primary-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 focus:ring-offset-surface transition-all shadow-lg shadow-primary-900/50">
                                <span class="absolute left-0 inset-y-0 flex items-center pl-3">
                                    <i
                                        class="ph-bold ph-sparkle text-primary-300 group-hover:text-white transition-colors"></i>
                                </span>
                                Gerar Análise Jurídica
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Resultado -->
            <div class="lg:col-span-7 h-full min-h-[600px] flex flex-col">
                <div
                    class="flex-grow bg-surface border border-border rounded-2xl overflow-hidden shadow-2xl relative flex flex-col">
                    <div class="bg-surfaceHighlight px-6 py-4 border-b border-border flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 rounded-full bg-red-500/20 border border-red-500/50"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-500/20 border border-yellow-500/50"></div>
                            <div class="w-3 h-3 rounded-full bg-green-500/20 border border-green-500/50"></div>
                            <span class="ml-2 text-sm font-medium text-gray-400">analise_gerada.txt</span>
                        </div>
                        <button onclick="copiarTexto()"
                            class="text-xs font-semibold text-gray-300 bg-border hover:bg-gray-600 px-3 py-1.5 rounded transition-colors flex items-center gap-2">
                            <i class="ph-bold ph-copy"></i> Copiar
                        </button>
                    </div>

                    <div class="relative flex-grow bg-[#151515] p-1">
                        <div id="loadingState"
                            class="hidden absolute inset-0 z-20 flex flex-col items-center justify-center bg-[#151515]/90 backdrop-blur-sm transition-opacity">
                            <div class="relative">
                                <div class="w-12 h-12 border-4 border-primary-900 rounded-full"></div>
                                <div
                                    class="w-12 h-12 border-4 border-primary-500 rounded-full border-t-transparent animate-spin absolute top-0 left-0">
                                </div>
                            </div>
                            <p class="mt-4 text-primary-400 font-medium animate-pulse">Consultando jurisprudência...</p>
                        </div>

                        <div id="emptyState"
                            class="absolute inset-0 flex flex-col items-center justify-center text-gray-600 pointer-events-none">
                            <i class="ph-duotone ph-file-text text-6xl mb-4 opacity-20"></i>
                            <p class="text-sm font-medium opacity-50">O resultado aparecerá aqui</p>
                        </div>

                        <textarea id="resultadoOutput"
                            class="w-full h-full p-6 sm:p-8 bg-transparent text-gray-300 font-mono text-sm leading-relaxed resize-none focus:outline-none custom-scrollbar relative z-10"
                            readonly spellcheck="false"></textarea>
                    </div>

                    <div
                        class="bg-surfaceHighlight px-4 py-2 border-t border-border flex justify-between items-center text-[10px] text-gray-500 uppercase tracking-widest">
                        <span>UTF-8</span>
                        <span id="tokenCount">0 CHARS</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- MODAL HISTÓRICO -->
    <div id="historyModal"
        class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
        <div
            class="bg-surface border border-border rounded-xl w-full max-w-lg shadow-2xl overflow-hidden flex flex-col max-h-[80vh]">
            <div class="p-4 border-b border-border flex justify-between items-center">
                <h3 class="text-lg font-bold text-white flex items-center gap-2">
                    <i class="ph-fill ph-clock-counter-clockwise text-primary-500"></i> Histórico (Nuvem)
                </h3>
                <button onclick="document.getElementById('historyModal').classList.add('hidden')"
                    class="text-gray-400 hover:text-white"><i class="ph-bold ph-x"></i></button>
            </div>
            <div id="historyList" class="p-4 overflow-y-auto space-y-2 flex-grow custom-scrollbar">
                <p class="text-center text-gray-500 py-8 animate-pulse">Carregando histórico do Firebase...</p>
            </div>
        </div>
    </div>

    <!-- MODAL MODELOS -->
    <div id="modelsModal"
        class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
        <div
            class="bg-surface border border-border rounded-xl w-full max-w-lg shadow-2xl overflow-hidden flex flex-col max-h-[80vh]">
            <div class="p-4 border-b border-border flex justify-between items-center">
                <h3 class="text-lg font-bold text-white flex items-center gap-2">
                    <i class="ph-fill ph-files text-primary-500"></i> Modelos Rápidos
                </h3>
                <button onclick="document.getElementById('modelsModal').classList.add('hidden')"
                    class="text-gray-400 hover:text-white"><i class="ph-bold ph-x"></i></button>
            </div>
            <div class="p-4 space-y-3 overflow-y-auto custom-scrollbar">
                <button onclick="window.loadTemplate('bpc_deficiente')"
                    class="w-full text-left p-3 rounded-lg border border-border hover:bg-surfaceHighlight hover:border-primary-500/50 transition-all group">
                    <div class="font-medium text-white group-hover:text-primary-400">BPC Deficiente (Padrão)</div>
                    <div class="text-xs text-gray-500 mt-1">Exemplo de epilepsia com CIDs comuns.</div>
                </button>
                <button onclick="window.loadTemplate('bpc_idoso')"
                    class="w-full text-left p-3 rounded-lg border border-border hover:bg-surfaceHighlight hover:border-primary-500/50 transition-all group">
                    <div class="font-medium text-white group-hover:text-primary-400">BPC Idoso</div>
                    <div class="text-xs text-gray-500 mt-1">Requerente com 67 anos, grupo familiar unipessoal.</div>
                </button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast"
        class="fixed bottom-6 right-6 bg-surface border border-border text-white px-5 py-4 rounded-xl shadow-2xl transform translate-y-32 opacity-0 transition-all duration-300 flex items-center gap-4 z-50">
        <div class="bg-green-500/20 p-2 rounded-full">
            <i class="ph-fill ph-check text-green-500"></i>
        </div>
        <div>
            <h4 class="font-bold text-sm">Sucesso!</h4>
            <p class="text-xs text-gray-400">Operação concluída.</p>
        </div>
    </div>

    <!-- Script Principal (Módulos) -->
    <script type="module" src="js/app.js"></script>
</body>

</html>